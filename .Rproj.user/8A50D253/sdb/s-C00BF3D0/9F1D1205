{
    "contents" : "# Clear memory from previous runs\nbase::rm(list=base::ls(all=TRUE))\n\n\n## @knitr LoadPackages\n# Load the necessary packages.\nbase::require(base)\nbase::require(knitr)\nbase::require(markdown)\nbase::require(testit)\nbase::require(dplyr)\nbase::require(reshape2)\nbase::require(stringr)\nbase::require(stats)\nbase::require(ggplot2)\n\n## @knitr DeclareGlobals\n\n\n## @knitr LoadData\n# loads basic NLSY97-religiosity data as defined in COAG-Colloquium-2014F repository\ndsL <- readRDS(\"./Data/Derived/dsL.rds\")\n\n\n\n## @knitr loadTheme\nbaseSize <- 12\n### <b>\nplotTheme <- ggplot2::theme_bw() +\n  ### </b>\n  ggplot2::theme_bw(base_size=baseSize)+\n  ggplot2::theme(title=ggplot2::element_text(colour=\"gray20\",size = baseSize + 3)) +\n  ggplot2::theme(axis.text=ggplot2::element_text(colour=\"gray40\", size= baseSize - 2))+\n  ggplot2::theme(axis.title.x=ggplot2::element_text(colour=\"gray40\", size = baseSize + 2, vjust=-.3))+\n  ggplot2::theme(axis.title.y=ggplot2::element_text(colour=\"gray40\", size = baseSize + 2, vjust=1.3))+\n  ggplot2::theme(panel.border = ggplot2::element_rect(colour=\"gray80\"))+\n  ggplot2::theme(axis.ticks.length = grid::unit(0, \"cm\"))\n\n## @knitr dsM00\ndsM <- dplyr::filter(dsL, id == 1) %>% \n  dplyr::select(id, year, attend, attendF)\ndsM\n\n\n## @knitr graphBasic\np <- ggplot2::ggplot(dsM,aes(x=year,y=attend))\np <- p + geom_line() + geom_point() + plotTheme\np <- p + scale_x_continuous(limits=c(2000,2011),\n                            breaks=c(2000:2011))\np <- p + scale_y_continuous(limits=c(1,8), \n                            breaks=seq(1,8, by=1))\np <- p + labs(list(\n  title=\"How often did you attend worship last year?\",\n  x=\"Year of observation\", y=\"Church attendance\"))\np \n\n\n## @knitr graphFullPrevious\ndsM <- dplyr::filter(dsL, id <=300, \n                     raceF != \"Mixed (Non-H)\") %>% \n  dplyr::select(id,sexF,raceF,year,attend,attendF) %>%\n  dplyr::mutate(yearc = year - 2000)\n#  \np <- ggplot2::ggplot(dsM,aes(x=yearc,y=attend))\np <- p + geom_line(aes(group=id), color='firebrick',\n           alpha=.2,\n           position=position_jitter(w=0.3, h=0.3))\np <- p + geom_point(shape=21, color=NA, fill=\"blue4\",\n           alpha=.4, size=1, \n           position=position_jitter(w=0.3, h=0.3))\np <- p + plotTheme\np <- p + scale_x_continuous(limits=c(0,11),\n                            breaks=c(0:11))\np <- p + scale_y_continuous(limits=c(0,8), \n                            breaks=seq(1,8, by=1))\np <- p + labs(list(\n title=\"How often did you attend worship last year?\",\n x=\"Years since 2000\", y=\"Church attendance\"))\np <- p + facet_grid(sexF~raceF)\np\n\n\n\n## @knitr dsM01\ndsM <- dplyr::filter(dsL, id == 1) %>%\n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend)\ndsM\n## @knitr graph01\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np\n\n\n## @knitr dsM02\ndsM <- dplyr::filter(dsL, id == 2) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend)\ndsM\n\n## @knitr graph02\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np\n\n\n## @knitr dsM03\ndsM <- dplyr::filter(dsL, id == 3) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend)\ndsM\n\n## @knitr graph03\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np\n\n## @knitr dsM04\ndsM <- dplyr::filter(dsL, id == 4) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend)\ndsM\n\n## @knitr graph04\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np\n\n\n## @knitr graph05\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=0,y=2), size=7, shape=\"O\", color=\"red\")\np\n\n## @knitr graph06\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=1,y=1), size=7, shape=\"O\", color=\"red\")\np\n\n## @knitr graph07\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=2,y=3), size=7, shape=\"O\", color=\"red\")\np\n\n## @knitr graph08\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=3,y=1), size=7, shape=\"O\", color=\"red\")\np\n\n## @knitr graph09\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=3,y=2), size=7, shape=\"O\", color=\"red\")\np\n\n## @knitr graph10\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=2,y=1), size=7, shape=\"O\", color=\"red\")\np\n\n## @knitr graph11\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_point(aes(x=1,y=6), size=7, shape=\"O\", color=\"red\")\np\n\n\n## @knitr dsM12\ndsM <- dplyr::filter(dsL, id == 1) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend)\ndsM$model <- 4\ndsM\n## @knitr graph12\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n## @knitr dsM13\ndsM <- dplyr::filter(dsL, id == 1) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 4 - dsM$time\ndsM\n## @knitr graph13\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n## @knitr dsM14\ndsM <- dplyr::filter(dsL, id == 1) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 4 - (.2)*dsM$time\ndsM\n## @knitr graph14\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n\n## @knitr dsM15\ndsM <- dplyr::filter(dsL, id == 2) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 1.8 + (.05)*dsM$time\ndsM\n## @knitr graph15\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n\n## @knitr dsM16\ndsM <- dplyr::filter(dsL, id == 3) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 2 + (.17)*dsM$time\ndsM\n## @knitr graph16\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n\n## @knitr dsM17\ndsM <- dplyr::filter(dsL, id == 4) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 1.5 + (.22)*dsM$time\ndsM\n## @knitr graph17\nsource(\"./Scripts/Graphs/basicTrajectory.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n## @knitr dsM18\ndsM <- dplyr::filter(dsL, id <= 4) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 3 - (.14)*dsM$time\ndplyr::filter(dsM,id==1)\n## @knitr graph18\np <- ggplot2::ggplot(dsM,aes(x=time,y=attend))\np <- p + geom_line(aes(group=id), color='firebrick',\n                   alpha=.2,\n                   position=position_jitter(w=0.1, h=0.1))\np <- p + geom_point(shape=1, color=\"black\", fill=NA,                 \n                    alpha=.4, size=2, \n                    position=position_jitter(w=0.1, h=0.1))\np <- p + plotTheme\np <- p + scale_x_continuous(limits=c(-.5,11),\n                            breaks=c(0:11))\np <- p + scale_y_continuous(limits=c(-.5,8.5), \n                            breaks=seq(1,8, by=1))\np <- p + labs(list(\n  title=\"How often did you attend worship last year?\",\n  x=\"Time scale: years since 2000\", y=\"Church attendance\"))\n#\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.5, alpha=.3)\np\n\n\n## @knitr dsM19\ndsM <- dplyr::filter(dsL, id <= 300) %>% \n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- 3 - (.14)*dsM$time\ndplyr::filter(dsM,id==1)\n## @knitr graph19\nsource(\"./Scripts/Graphs/basicTrajectory300.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.7, alpha=.5)\np\n\n## @knitr dsM20\ndsM <- dplyr::filter(dsL, id <= 300) %>% \n  dplyr::filter(ave((!is.na(attend)), id, FUN = all)) %>%\n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- predict (lm(attend ~ 1, data=dsM))\ndplyr::filter(dsM,id==1)\n## @knitr graph20\nsource(\"./Scripts/Graphs/basicTrajectory300.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.7, alpha=.5)\np\n\n\n## @knitr dsM21\ndsM <- dplyr::filter(dsL, id <= 300) %>% \n  dplyr::filter(ave((!is.na(attend)), id, FUN = all)) %>%\n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend) \ndsM$model <- predict (lm(attend ~ 1 + time, data=dsM))\ndplyr::filter(dsM,id==1)\n## @knitr graph21\nsource(\"./Scripts/Graphs/basicTrajectory300.R\")\np <- p + geom_line(aes(y=model), color=\"blue4\", linetype=\"solid\", size=1.7, alpha=.5)\np\n\n\n## @knitr dsM22\ndsM <- dplyr::filter(dsL, id <= 300) %>% \n  dplyr::filter(ave((!is.na(attend)), id, FUN = all)) %>%\n  dplyr::mutate(time=year-2000) %>%\n  dplyr::select(id, time, attend)\nmodelA <- lm(attend ~ 1, data=dsM)\nmodelB <- lm(attend ~ 1 + time, data=dsM)\ndplyr::filter(dsM,id==1)\n\n## @knitr model0\nsummary(modelA)\n\n\n#\n#\nsummary(modelB)\n\n\n\n## @knitr model1\ndeviance(modelA)\nBIC(modelA)\nAIC(modelA)\n\n\n\n#\n#\n\n\ndeviance(modelB)\nBIC(modelB)\nAIC(modelB)\n\n\n",
    "created" : 1415922467000.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2627408434",
    "id" : "9F1D1205",
    "lastKnownWriteTime" : 1415989797,
    "path" : "~/GitHub/COAG-colloquium-2014F/Reports/2014-11-18-Statistical-Modeling.R",
    "project_path" : "Reports/2014-11-18-Statistical-Modeling.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}